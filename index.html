<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Required meta tags always come first-->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, inital-scale-1, shrink-to-fit=no">
    <meta http-quiv="x-ua-compatible" content="ie=edge">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <script src="https://kit.fontawesome.com/c7a2245c61.js" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-social/4.0.2/bootstrap-social.css">

    <title>Chapraya Vet - Ayutthaya</title>
    <meta name="keywords" content="HTML, learn, language, chinese, revision, study, thai, 
    english, self-study, review, chaopraya, soft, me, learning, chinese, conversation, prasertsak,
    tiawongsombat, vocab, writing, collection, practice" />
    <meta name="description" content="Chinese conversation, vocabulary, and writing collection" />
    <meta name="author" content="Prasertsak Tiawongsombat" />
</head>

<body>


    <nav class="navbar navbar-dark navbar-expand-sm bg-primary fixed-top">
        <div class="container">
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#Navbar"
                aria-controls="navigation-index">
                <span class="navbar-toggler-icon"></span>
            </button>
            <a class="navbar-brand mr-auto ml-2" href="#"><img src="img/dog_1_menu_icon.png" height="30" width="41"
                    class="img-fluid"></a>
            <div class="collapse navbar-collapse" id="Navbar">
                <ul class="navbar-nav mr-auto">
                    <li class="nav-item active"><a class="nav-link" href="#"><span class="fa-solid fa-v fa-lg"></span>
                            Home</a></li>
                    <li class="nav-item"><a class="nav-link" href="./aboutus.html"><span
                                class="fa-solid fa-e fa-lg"></span> About Us</a></li>
                    <li class="nav-item"><a class="nav-link" href="./contactus.html">
                            <span class="fa-solid fa-t fa-lg"></span> Contact Us</a></li>

                </ul>
            </div>
        </div>
    </nav>

    <header class="jumbotron">
        <div class="container">
            <div class="row row-header">
                <div class="col-12 col-sm-6">
                    <h1>Chapraya Vet - Ayutthaya</h1>
                    <h1 style="color: rgb(194, 227, 144);">Profile & Vaccine record</h1>

                </div>
                <div class="col-12 col-sm align-self-center">
                    <img src="img/logo1_1.png" width="250" class="img-fluid">
                </div>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="row row-content align-items-center">
            <div class="col-12">
                <h3>Test</h3>

                <form class="container" id="contactForm">
                    <div class="card">
                        <div class="card-body">
                            <div class="form-group">
                                <label for="exampleFormControlInput1">
                                    Enter Your Name
                                </label>

                                <input type="text" class="form-control" id="nameSubmit" placeholder="Enter your name">
                            </div>

                            <div class="form-group">
                                <label for="exampleFormControlInput1">
                                    Email address
                                </label>

                                <input type="email" class="form-control" id="emailSubmit"
                                    placeholder="name@example.com">
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary" style="margin-left: 15px; margin-top: 10px">
                            Submit
                        </button>

                    </div>
                </form>
            </div>
            <div class="col-12">
                <form class="container" id="getForm">
                    <div class="card">
                        <div class="card-body">
                            <div class="form-group">
                                <label for="exampleFormControlInput1">
                                    Enter Your Name
                                </label>

                                <input type="text" class="form-control" id="nameGet" placeholder="Enter your name">
                            </div>

                            <button id="btn-get" class="btn btn-success" style="margin-left: 15px; margin-top: 10px">
                                Get
                            </button>

                        </div>
                    </div>
                </form>
            </div>
            <div class="col-12">
                <form class="container" id="delForm">
                    <div class="card">
                        <div class="card-body">
                            <div class="form-group">
                                <label for="exampleFormControlInput2">
                                    Enter Your Name
                                </label>

                                <input type="text" class="form-control" id="nameDel" placeholder="Enter your name">
                            </div>

                            <button id="btn-del" class="btn btn-primary" style="margin-left: 15px; margin-top: 10px">
                                Del
                            </button>


                        </div>
                    </div>
                </form>
            </div>

            <div class="col-12">
                <form class="container" id="searchForm">
                    <div class="card">
                        <div class="card-body">
                            <div class="form-group">
                                <label for="exampleFormControlInput3">
                                    กรุณาใส่เลขบัตรประชาชน
                                </label>

                                <input type="text" class="form-control" id="idSearch" placeholder="เลขบัตรประชาชน">
                            </div>

                            <div class="form-group">
                                <label for="exampleFormControlInput3">
                                    โปรดระบุเลขเครื่องยนต์
                                </label>

                                <input type="text" class="form-control" id="chassisSearch" placeholder="เลขเครื่องยนต์">
                            </div>

                            <button id="btn-search" class="btn btn-primary" style="margin-left: 15px; margin-top: 10px">
                                ค้นหา
                            </button>


                        </div>
                    </div>
                </form>
            </div>

        </div>

        <div class="row row-content align-items-top">
            <div class="col-12">
                <div class="card">
                    <div class="card-body">
                        <p id="t1">jjjjj</p>

                    </div>

                </div>
            </div>
        </div>

    </div>


    <footer class="footer">
        <div class="container">
            <div class="row">

                <div class="col-7 col-sm-6">
                    <h5>Our Address</h5>
                    <address>
                        Ayutthaya + Bangkok + Nonthaburi <br>
                        THAILAND<br>
                        <i class="fa fa-phone fa-lg"></i> : xxxxxxxxxx <br>
                        <i class="fa fa-fax fa-lg"></i> : xxxxxxxxxx <br>
                        <i class="fa-regular fa-paper-plane fa-lg"></i> : <a
                            href="mailto:tiawongsombat@gmail.com">tiawongsombat@gmail.com</a>
                    </address>
                </div>
                <div class="col-12 col-sm-6 align-self-center">
                    <div class="text-center">
                        <a class="btn btn-social-icon btn-google" href="http://google.com/+"><i
                                class="fa fa-google-plus"></i></a>
                        <a class="btn btn-social-icon btn-facebook" href="http://www.facebook.com/profile.php?id="><i
                                class="fa fa-facebook"></i></a>
                        <a class="btn btn-social-icon btn-linkedin" href="http://www.linkedin.com/in/"><i
                                class="fa fa-linkedin"></i></a>
                        <a class="btn btn-social-icon btn-twitter" href="http://twitter.com/"><i
                                class="fa fa-twitter"></i></a>
                        <a class="btn btn-social-icon btn-google" href="http://youtube.com/"><i
                                class="fa fa-youtube"></i></a>
                        <a class="btn btn-social-icon" href="mailto:"><i class="fa fa-envelope-o"></i></a>
                    </div>
                </div>
            </div>
            <div class="row justify-content-center">
                <div class="col-auto">
                    <p>© Copyright 2022 Me-Learning-Chinese</p>
                    <div class="powr-hit-counter" id="e6c10ee9_1658744890"></div>
                    <script src="https://www.powr.io/powr.js?platform=html"></script>
                </div>
            </div>
        </div>
    </footer>
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.6/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

    <!-- Back to top button -->
    <button type="button" class="btn btn-danger btn-floating btn-lg" id="btn-back-to-top">
        <i class="fas fa-arrow-up"></i>
    </button>
    <script>
        //Get the button
        let mybutton = document.getElementById("btn-back-to-top");

        // When the user scrolls down 20px from the top of the document, show the button
        window.onscroll = function () {
            scrollFunction();
        };

        function scrollFunction() {
            if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
                mybutton.style.display = "block";
            } else {
                mybutton.style.display = "none";
            }
        }
        // When the user clicks on the button, scroll to the top of the document
        mybutton.addEventListener("click", backToTop);

        function backToTop() {
            document.body.scrollTop = 0;
            document.documentElement.scrollTop = 0;
        }

    </script>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/3.7.4/firebase.js"></script>
    <script type="module">
        // Import the functions you need from the SDKs you need
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-app.js";
        import { getDatabase, set, get, ref, push, child, onValue, remove, query, orderByChild, equalTo } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-database.js";
        //import { getAnalytics } from "https://www.gstatic.com/firebasejs/9.9.2/firebase-analytics.js";

        // TODO: Add SDKs for Firebase products that you want to use
        // https://firebase.google.com/docs/web/setup#available-libraries

        // Your web app's Firebase configuration
        // For Firebase JS SDK v7.20.0 and later, measurementId is optional
        const firebaseConfig = {
            apiKey: "AIzaSyBUZJmCcVs5W80ixXUT7N74mtziMkb1IlA",
            authDomain: "chaopraya-vet.firebaseapp.com",
            databaseURL: "https://chaopraya-vet-default-rtdb.firebaseio.com",
            projectId: "chaopraya-vet",
            storageBucket: "chaopraya-vet.appspot.com",
            messagingSenderId: "477585373518",
            appId: "1:477585373518:web:8e7d2e46a4de04dd14061f",
            //measurementId: "G-1085ZG3BEM"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);


        document.getElementById('contactForm').addEventListener('submit', submitForm);
        document.getElementById('getForm').addEventListener('submit', getMessage);
        document.getElementById('delForm').addEventListener('submit', delNode);

        document.getElementById('searchForm').addEventListener('submit', searchInfo);

        function submitForm(e) {
            e.preventDefault();

            // Get values
            var name = getInputVal('nameSubmit');
            var email = getInputVal('emailSubmit');


            saveMessage(name, email);
            document.getElementById('contactForm').reset();
        }

        // Function to get get form values
        function getInputVal(id) {
            return document.getElementById(id).value;
        }

        // Save message to firebase
        function saveMessage(name, email) {

            const userId = push(child(ref(database), 'customerData')).key;
            set(ref(database, 'customerData/' + userId), {
                name: name,
                email: email,
            });

            alert("saved");
        }

        // get message from firebase

        function getMessage(e) {
            e.preventDefault();
            //const Ref = ref(database, 'customerData/');
            const Ref = ref(database, '0');
            //const Ref = ref(database, 'customerData/');
            alert('get');
            onValue(Ref, (snapshot) => {
                const data = snapshot.val();
                const count = Object.keys(data).length;
                alert(count);
                snapshot.forEach((childSnapshot) => {
                    const childKey = childSnapshot.key;
                    const childData = childSnapshot.val();
                    //alert(childData.name + ", " + childData.email);
                    alert(childKey + ", " + childData);
                    console.log(childSnapshot.val());

                });
            }, {
                onlyOnce: true
            });

        }

        function delNode(e) {
            e.preventDefault();
            var name_to_delete = getInputVal('nameDel');
            alert("name to delete = " + name_to_delete);
            const Ref = ref(database, 'customerData/');
            //const Ref = ref(database, 'customerData/');
            var key_to_delete;

            const test = query(Ref, orderByChild('name'), equalTo(name_to_delete));

            alert(test);

            onValue(test, (snapshot) => {
                //console.log(Object.keys(snapshot.val()));
                snapshot.forEach((childSnapshot) => {
                    const childKey = childSnapshot.key;
                    remove(ref(database, 'customerData/' + childKey));
                })

            });

        }

        function searchInfo(e) {
            e.preventDefault();
            let text = "Hello Dolly";
            let text2 = "Hello Dolly2";
            const element = document.getElementById("t1");
            
            //document.getElementById("t1").innerHTML = text;
            element.innerHTML = "";

            //e.preventDefault();
            var id_to_search = getInputVal('idSearch');
            const Ref = ref(database);
            //const test = query(Ref, orderByChild('id'), equalTo(3140400276716));
            const test = query(Ref, orderByChild('id'), equalTo(parseInt(id_to_search)));
            //console.log(test);

            onValue(test, (snapshot) => {
                //console.log(Object.keys(snapshot.val()));
                snapshot.forEach((childSnapshot) => {
                    
                        const childKey = childSnapshot.key;
                        const childData = childSnapshot.val();
                        console.log(childData);
                        element.innerHTML += "<p>"+childData.initial+childData.name+"</p>";
                        element.innerHTML += "<p>"+childData.id+"</p>";
                        element.innerHTML += "<p>"+childData.model+"</p>";
                        element.innerHTML += "<p>"+childData.chasisNumber+"</p>";
                        element.innerHTML += "<p>"+childData.buyingDate+"</p>";
                        element.innerHTML += "<p>"+childData.registrationNumber+"</p>";
                        element.innerHTML += "<p>"+childData.taxDueDate+"</p>";
                        element.innerHTML += "<p>"+childData.monthDueDate+"</p>";


                   
                    
                })

            });

        }





    </script>





</body>

</html>